# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```
Приложение реализовано по MVP архитектуре и состоит из классы моделей и классов представления. В приложении используется событийно-ориентированный подход. 

 #### Класс Api
Содержит в себе базовую логику отправки запросов. В конструктор передается базовый адрес сервера и объект с заголовками запросов.
Методы класса:
- `get` — выполняет GET-запрос на переданный в параметрах ендпоинт и возвращает промис с объектом, которым ответил сервер;
- `post` — принимает объект с данными, которые будут переданы в JSON-формате в теле запроса, и отправляет эти данные на ендпоинт, переданный как параметр при вызове метода. По умолчанию выполняется POST-запрос, но метод запроса может быть переопределен заданием третьего параметра при вызове.

#### Класс EventEmitter

Брокер событий позволяет отправлять события и подписываться на события, происходящие в системе. Класс используется в Presenter для обработки событий и в слоях приложения для генерации событий.

- `on` — подписка на событие;
- `emit — инициализация события;
- `trigger` — возвращает функцию, при вызове которой инициализируется требуемое в параметрах событие.

### Слой Modal

#### Класс ProductModel

Класс отвечает за управление информацией о товарах

Поля класса:

- `id` Уникальный идентификатор товара.
- `description` — Описание товара.
- `image` — Путь к изображению товара.
- `title` — Название товара.
- `category` — Категория товара.
- `price` — Цена товара

Методы класса:

- `getProductDetails()` — Метод для получения полной информации о продукте.

#### Класс OrderModel

Класс отвечает за управление информацией о заказах.

Поля класса:

- `payment` — Способ оплаты заказа.
- `email` — Электронная почта покупателя.
- `phone` — Телефонный номер покупателя.
- `address` — Адрес доставки.
- `total` — Общая сумма заказа.
- `items` — Список товаров в заказе.

Методы класса:

- `getOrderDetails()` — Метод для получения полной информации о заказе в виде объекта. Возвращает объект с данными заказа.
- `updateOrderDetails()` — Метод для обновления информации о заказе. Принимает объект с новыми значениями полей заказа и обновляет соответствующие свойства.

### Слой View

Классы отвечают за отображение данных в соответствующих элементах интерфейса

#### Базовый Класс Component

Класс Component является абстрактным и используется как базовый для всех компонентов слоя View.

Методы класса:

- `render()` — Метод для отображения данных в компоненте

#### Класс Card

Отвечает за отображение карточки товара, включая название, изображение, цену и категорию. Класс используется для отображения товаров на странице сайта и для открытия модального окна с деталями товара при нажатии на карточку.

Поля класса:

- `element` — Основной DOM элемент карточки.
- `events` — Экземпляр класса EventEmitter для обработки событий.

Методы класса:

- `render()` — Отображает данные о товаре в карточке.
- `openProductModal()` — Метод для открытия модального окна с подробной информацией о товаре.

#### Класс CardsContainer

Отвечает за отображение блока с карточками товаров на главной странице. Класс управляет размещением карточек в указанном контейнере.

Поля класса:

- `container` — Элемент контейнера, в который будут добавляться карточки.
- `events` — Экземпляр класса EventEmitter для обработки событий, связанных с карточками.

Методы класса:

- `render` — Метод для отображения карточек товаров. 

#### Класс Modal

Класс отвечает за управление модальным окном на странице.

Поля класса:

- `modal` — Элемент модального окна, найденный по переданному селектору.
- `events` — Экземпляр брокера событий для управления событиями, связанными с модальным окном.

Методы класса:

- `open()` — Метод для открытия модального окна. 
- `close()` — Метод для закрытия модального окна. 

#### Класс CardModal

Расширяет класс Modal. Отвечает за реализацию модального окна, отображающего подробности о товаре. Позволяет взаимодействовать с товаром (например, добавление в корзину).

Поля класса:

- `modal` — Элемент модального окна, унаследованный от базового класса Modal.
- `events` — Экземпляр класса EventEmitter для инициации и обработки событий.
- `onAddToBasket` — Обработчик для выполнения действия добавления товара в корзину.
- `productData` — Данные о товаре, которые будут отображаться в модальном окне.

Методы класса:

- `open` — Расширяет метод open из базового класса Modal. Принимает объект товара ProductModel и устанавливает его данные в модальном окне.
- `close` — Расширяет метод close из базового класса Modal. Используется для скрытия модального окна и сброса состояния.
- `setupEventListeners()` — Приватный метод. Устанавливает слушатели событий для кнопки "В корзину". Вызывается в конструкторе для инициализации специфичных событий.
- `setCardData()` — Метод для установки данных о товаре в модальном окне. Обновляет информацию, отображаемую в модальном окне, на основе переданного объекта ProductModel.

#### Класс BasketModal
Расширяет класс Modal. Отвечает за отображение и управление корзиной товаров.

Поля класса:

- `modal` — Элемент модального окна, унаследованный от базового класса Modal.
- `events` — Экземпляр класса EventEmitter для инициации и обработки событий.
- `onCheckout` — Обработчик для оформления заказа.
- `cartItems` — Массив товаров, добавленных в корзину.
- `totalPrice` — Общая сумма заказа, рассчитанная на основе цен товаров в корзине.

Методы класса:

- `open()` — Расширяет метод open из базового класса Modal. Отображает товары в корзине и устанавливает обработчик для оформления заказа. 
- `setupEventListeners()` — Приватный метод. Устанавливает слушатели событий для кнопок "Удалить товар" и "Оформить заказ".
- `removeItem()` — Удаляет товар из корзины.
- `updateBasketItems()` — Обновляет отображаемые товары в корзине 
- `submitOrder()` — Инициирует процесс оформления заказа, передавая массив товаров через событие или вызов обработчика onCheckout.
- `renderBasketItems()` - Отображает текущие товары в корзине

#### Класс OrderDetailsModal

Расширяет класс Modal. Отвечает за отображение и управление формой оформления заказа в два этапа: выбор способа оплаты и доставки, а затем ввод контактной информации.

Поля класса:

- `modal` — Элемент модального окна, унаследованный от базового класса Modal.
- `events` — Экземпляр класса EventEmitter для обработки событий.
- `onSubmit` — Обработчик для передачи данных заказа при его оформлении.
- `payment` — Выбранный способ оплаты.
- `address` — Адрес доставки, введенный пользователем.
- `email` — Email клиента, введенный на втором этапе.
- `phone`— Номер телефона клиента, введенный на втором этапе.
- `currentStep` — Номер текущего шага оформления (1 или 2).

Методы класса:

- `open()` — Расширяет метод open из базового класса Modal. Отображает первый этап формы (выбор оплаты и доставки)
- `close()`— Расширяет метод close из базового класса Modal. Скрывает модальное окно и сбрасывает введенные данные.
- `setupEventListeners()` — Приватный метод. Устанавливает слушатели событий для полей формы и кнопок. Управляет переходами между этапами формы, валидацией данных и изменением текста на кнопках ("Далее", "Оплатить", "Оформить").
- `validateStep1()` — Проверяет правильность заполнения полей первого этапа 
- `validateStep2()` — Проверяет правильность полей второго этапа (email и телефон). 
- `goToNextStep()` — Скрывает поля первого этапа и отображает второй этап (контактная информация).
- `submitOrder()` — Формирует объект заказа и передает его в обработчик onSubmit. 

#### Класс SuccessModal
Расширяет класс Modal. Отвечает за отображение сообщения об успешном завершении заказа.

Поля класса:

- `modal` — Элемент модального окна, унаследованный от базового класса Modal.
- `events` — Экземпляр класса EventEmitter для обработки событий.
- `amount` — Сумма, списанная за заказ.

Методы класса:

- `open()` — Расширяет метод open из базового класса Modal. Принимает сумму заказа и отображает ее вместе с сообщением об успешном оформлении.
- `close()` — Расширяет метод close из базового класса Modal. Используется для скрытия модального окна и сброса состояния.


#### Класс AppPresenter
Отвечает за взаимодействие между слоями представления и моделью данных. 

Методы класса:

- `initialize()` — Инициализирует обработку событий и устанавливает начальное состояние представления.
- `handleProductSelect()` — Обрабатывает выбор товара для отображения в модальном окне. 
- `handleAddToCart()`— Обрабатывает добавление товара в корзину. 
- `handleBasketOpen()` — Открывает модальное окно корзины и отображает текущее состояние корзины.
- `handleOrderSubmit()` — Обрабатывает оформление заказа.
- `handleSuccess()` — Обрабатывает успешное завершение заказа, отображает соответствующее сообщение в SuccessModal.